---
- name: Install Docker
  hosts: ubuntu
  become: true

  tasks:
  - name: Update apt package index
    apt: update_cache=yes

  - name: Install packages to allow apt to use a repository over HTTPS
    apt: name=apt-transport-https,ca-certificates,curl,software-properties-common state=installed

  - name: Add Docker's official GPG key
    apt_key: url=https://download.docker.com/linux/ubuntu/gpg state=present

  - name: Add Docker repository
    apt_repository: repo='deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_lsb.codename }} stable'

  - name: Install Docker CE
    apt: name=docker-ce state=installed

  - name: Start and enable Docker service
    service: name=docker state=started enabled=yes

  - name: Docker version
    command: docker version
